<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>刮刮卡</title>
<meta name="keywords" content="楼市第二波救市刚需放贷 地方各自为政难破局" />
<meta name="description" content="楼市第二波救市刚需放贷 地方各自为政难破局" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<style>
body,div{padding: 0; margin: 0;}
.wrap {
    width: 320px;
    height: 400px;
    background: url('http://s1.ifengimg.com/2015/05/27/14a99b65f24474a81530c6f642c1ef4f.jpg') 0 0 no-repeat;
    background-size: 100% 100%;
}
</style>
</head>
<body>
<div id="con" class="wrap">
    <canvas id="myCanvas" width="320" height="400"></canvas>
</div>
<script>
var myCanvas = document.getElementById('myCanvas');
var gray = myCanvas.getContext('2d');
gray.beginPath();
gray.fillStyle = "#999";
gray.fillRect(0,0,320,400);
gray.closePath();
gray.globalCompositeOperation="destination-out";

myCanvas.addEventListener('touchmove', function(e){
    e.preventDefault();
    gray.beginPath();
    gray.fillStyle = "#f00";
    gray.arc(e.targetTouches[0].clientX, e.targetTouches[0].clientY, 20, 0, Math.PI*2);
    gray.fill();
    gray.closePath();
}, false);

myCanvas.addEventListener('touchend', function(e){
    e.preventDefault();
    var num = 0;
    var datas = gray.getImageData(0,0,320,400);//画布中像素点属性
    for (var i = 0; i < datas.data.length; i++) {
        if (datas.data[i] == 0) {
            num++;
        };
    };
    if (num >= datas.data.length * 0.7) {
        gray.fillRect(0,0,320,400);
    };
}, false);
</script>
</body>
</html>
